<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ilija DMS â€“ Dokumentenarchiv</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
/* â”€â”€ Reset & Variablen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:        #080C0A;
  --bg2:       #0E1410;
  --bg3:       #141C17;
  --bg4:       #1A2420;
  --border:    #1E2E28;
  --border2:   #2A3E36;
  --green:     #00C87A;
  --green2:    #00A362;
  --green3:    #004D2F;
  --greenDim:  rgba(0,200,122,.08);
  --greenGlow: rgba(0,200,122,.15);
  --text:      #E8F4EF;
  --text2:     #8BA99A;
  --text3:     #506860;
  --warn:      #F5A623;
  --warnBg:    rgba(245,166,35,.08);
  --red:       #FF4757;
  --redBg:     rgba(255,71,87,.08);
  --radius:    10px;
  --radius2:   6px;
  --font:      'Syne', sans-serif;
  --mono:      'JetBrains Mono', monospace;
  --transition: 180ms ease;
  --shadow:    0 4px 24px rgba(0,0,0,.4);
}

html { font-size: 15px; }
body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â”€â”€ Scrollbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

/* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.shell {
  display: grid;
  grid-template-columns: 260px 1fr;
  grid-template-rows: 56px 1fr;
  height: 100vh;
  grid-template-areas:
    "topbar topbar"
    "sidebar main";
}

/* â”€â”€ Topbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.topbar {
  grid-area: topbar;
  background: var(--bg2);
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  padding: 0 20px;
  gap: 20px;
  position: sticky;
  top: 0;
  z-index: 100;
}

.topbar-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  flex-shrink: 0;
}
.topbar-logo .logo-mark {
  width: 30px; height: 30px;
  background: var(--green);
  border-radius: 8px;
  display: grid;
  place-items: center;
  font-size: 14px;
  font-weight: 800;
  color: var(--bg);
}
.topbar-logo span {
  font-size: .85rem;
  font-weight: 700;
  color: var(--text);
  letter-spacing: .04em;
}
.topbar-logo em {
  font-style: normal;
  color: var(--green);
  margin-left: 4px;
}

.topbar-divider { width: 1px; height: 28px; background: var(--border); flex-shrink: 0; }

.search-wrap {
  flex: 1;
  max-width: 480px;
  position: relative;
}
.search-wrap .icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text3);
  font-size: 14px;
  pointer-events: none;
}
#searchInput {
  width: 100%;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: var(--radius2);
  padding: 8px 12px 8px 36px;
  font-family: var(--mono);
  font-size: .8rem;
  color: var(--text);
  outline: none;
  transition: border-color var(--transition);
}
#searchInput::placeholder { color: var(--text3); }
#searchInput:focus { border-color: var(--green); }

.topbar-actions { display: flex; align-items: center; gap: 8px; margin-left: auto; }

.btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  border-radius: var(--radius2);
  font-family: var(--font);
  font-size: .8rem;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  border: none;
  letter-spacing: .02em;
  white-space: nowrap;
}
.btn-primary {
  background: var(--green);
  color: var(--bg);
}
.btn-primary:hover { background: var(--green2); transform: translateY(-1px); }
.btn-ghost {
  background: transparent;
  color: var(--text2);
  border: 1px solid var(--border2);
}
.btn-ghost:hover { background: var(--bg3); color: var(--text); border-color: var(--green); }
.btn:disabled { opacity: .4; cursor: not-allowed; transform: none !important; }

/* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar {
  grid-area: sidebar;
  background: var(--bg2);
  border-right: 1px solid var(--border);
  overflow-y: auto;
  padding: 16px 0;
}

.sidebar-section { margin-bottom: 8px; }

.sidebar-label {
  padding: 4px 16px 8px;
  font-size: .65rem;
  font-weight: 700;
  letter-spacing: .1em;
  text-transform: uppercase;
  color: var(--text3);
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 16px;
  cursor: pointer;
  border-radius: 0;
  transition: all var(--transition);
  color: var(--text2);
  font-size: .85rem;
  font-weight: 500;
  border-left: 2px solid transparent;
  user-select: none;
}
.sidebar-item:hover { background: var(--greenDim); color: var(--text); border-left-color: var(--border2); }
.sidebar-item.active { background: var(--greenDim); color: var(--green); border-left-color: var(--green); }
.sidebar-item .icon { font-size: 15px; flex-shrink: 0; width: 18px; text-align: center; }
.sidebar-item .badge {
  margin-left: auto;
  background: var(--bg4);
  color: var(--text3);
  font-size: .65rem;
  font-family: var(--mono);
  padding: 2px 7px;
  border-radius: 20px;
  border: 1px solid var(--border2);
}
.sidebar-item.active .badge { background: var(--green3); color: var(--green); border-color: transparent; }

.sidebar-tree { padding: 0 0 0 32px; }
.sidebar-tree .sidebar-item { font-size: .8rem; color: var(--text3); padding: 7px 16px 7px 8px; }
.sidebar-tree .sidebar-item:hover { color: var(--text); }
.sidebar-tree .sidebar-item.active { color: var(--green); }

/* â”€â”€ Stats Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.stats-bar {
  margin: 0 16px 16px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: var(--radius2);
  padding: 12px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}
.stat-item { text-align: center; }
.stat-value {
  font-family: var(--mono);
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--green);
}
.stat-label {
  font-size: .65rem;
  color: var(--text3);
  text-transform: uppercase;
  letter-spacing: .06em;
}

/* â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main {
  grid-area: main;
  overflow-y: auto;
  background: var(--bg);
}

/* â”€â”€ Panels â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.panel { display: none; padding: 28px; }
.panel.active { display: block; animation: fadeIn .2s ease; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: none; } }

.panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
  flex-wrap: wrap;
  gap: 12px;
}
.panel-title {
  font-size: 1.4rem;
  font-weight: 800;
  color: var(--text);
  letter-spacing: -.01em;
}
.panel-title span { color: var(--green); }

/* â”€â”€ Upload Zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.drop-zone {
  border: 2px dashed var(--border2);
  border-radius: var(--radius);
  padding: 48px 32px;
  text-align: center;
  cursor: pointer;
  transition: all .25s ease;
  background: var(--bg2);
  position: relative;
  overflow: hidden;
}
.drop-zone::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at center, var(--greenGlow) 0%, transparent 70%);
  opacity: 0;
  transition: opacity .3s ease;
}
.drop-zone:hover, .drop-zone.dragover {
  border-color: var(--green);
  background: var(--greenDim);
}
.drop-zone:hover::before, .drop-zone.dragover::before { opacity: 1; }
.drop-zone .dz-icon {
  font-size: 2.5rem;
  margin-bottom: 12px;
  display: block;
  transition: transform .3s ease;
}
.drop-zone:hover .dz-icon { transform: translateY(-4px); }
.drop-zone .dz-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 6px;
}
.drop-zone .dz-sub {
  font-size: .8rem;
  color: var(--text3);
  font-family: var(--mono);
  line-height: 1.6;
}
#fileInput { display: none; }

/* â”€â”€ Import List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.import-list {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.import-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius2);
  transition: all var(--transition);
  animation: slideIn .2s ease;
}
@keyframes slideIn { from { opacity: 0; transform: translateX(-8px); } to { opacity: 1; transform: none; } }

.import-item:hover { border-color: var(--border2); background: var(--bg3); }
.file-ext {
  width: 36px; height: 36px;
  border-radius: var(--radius2);
  display: grid;
  place-items: center;
  font-size: .65rem;
  font-weight: 700;
  font-family: var(--mono);
  letter-spacing: .05em;
  text-transform: uppercase;
  flex-shrink: 0;
}
.ext-pdf  { background: rgba(255,71,87,.15);  color: #FF4757; }
.ext-docx, .ext-doc { background: rgba(41,128,255,.15); color: #2980FF; }
.ext-xlsx, .ext-xls { background: rgba(39,174,96,.15);  color: #27AE60; }
.ext-img  { background: rgba(155,89,182,.15); color: #9B59B6; }
.ext-txt, .ext-csv, .ext-md { background: rgba(149,165,166,.15); color: #95A5A6; }
.ext-default { background: var(--bg4); color: var(--text3); }

.import-item-info { flex: 1; min-width: 0; }
.import-item-name {
  font-size: .85rem;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.import-item-meta { font-size: .73rem; color: var(--text3); font-family: var(--mono); margin-top: 2px; }

.import-item-del {
  background: none;
  border: none;
  color: var(--text3);
  cursor: pointer;
  padding: 6px;
  border-radius: 4px;
  transition: all var(--transition);
  font-size: 14px;
  flex-shrink: 0;
}
.import-item-del:hover { background: var(--redBg); color: var(--red); }

.sort-bar {
  margin-top: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  background: var(--greenDim);
  border: 1px solid var(--green3);
  border-radius: var(--radius2);
}
.sort-bar p { flex: 1; font-size: .85rem; color: var(--text2); }
.sort-bar strong { color: var(--green); }

/* â”€â”€ Sort Output â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sort-output {
  margin-top: 16px;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius2);
  padding: 16px;
  font-family: var(--mono);
  font-size: .8rem;
  color: var(--text2);
  line-height: 1.9;
  max-height: 340px;
  overflow-y: auto;
  white-space: pre-wrap;
  display: none;
}
.sort-output.visible { display: block; animation: fadeIn .3s ease; }

/* â”€â”€ Archive Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.archive-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 12px;
}

.cat-card {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 18px;
  cursor: pointer;
  transition: all .2s ease;
  position: relative;
  overflow: hidden;
}
.cat-card::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 2px;
  background: var(--green);
  transform: scaleX(0);
  transition: transform .2s ease;
  transform-origin: left;
}
.cat-card:hover { border-color: var(--green); transform: translateY(-2px); box-shadow: var(--shadow); }
.cat-card:hover::after { transform: scaleX(1); }
.cat-card .cat-icon { font-size: 1.8rem; margin-bottom: 10px; }
.cat-card .cat-name { font-size: .95rem; font-weight: 700; color: var(--text); margin-bottom: 4px; }
.cat-card .cat-count { font-size: .75rem; font-family: var(--mono); color: var(--green); }

/* â”€â”€ File List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.file-list { display: flex; flex-direction: column; gap: 4px; }

.file-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 14px;
  border-radius: var(--radius2);
  transition: all var(--transition);
  cursor: default;
}
.file-row:hover { background: var(--bg3); }
.file-row .file-info { flex: 1; min-width: 0; }
.file-row .file-name {
  font-size: .85rem;
  font-weight: 500;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.file-row .file-meta { font-size: .72rem; font-family: var(--mono); color: var(--text3); margin-top: 2px; }
.file-row .file-actions { display: flex; gap: 4px; opacity: 0; transition: opacity var(--transition); }
.file-row:hover .file-actions { opacity: 1; }
.file-action-btn {
  background: none;
  border: 1px solid var(--border2);
  color: var(--text3);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: .72rem;
  font-family: var(--mono);
  transition: all var(--transition);
}
.file-action-btn:hover { background: var(--greenDim); color: var(--green); border-color: var(--green); }

.breadcrumb {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}
.breadcrumb-item {
  font-size: .8rem;
  color: var(--text3);
  cursor: pointer;
  transition: color var(--transition);
  font-weight: 500;
}
.breadcrumb-item:hover { color: var(--green); }
.breadcrumb-item.current { color: var(--text); cursor: default; }
.breadcrumb-sep { color: var(--text3); font-size: .7rem; }

/* â”€â”€ Search Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.search-results { display: flex; flex-direction: column; gap: 4px; }

.search-result-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius2);
  transition: all var(--transition);
}
.search-result-item:hover { border-color: var(--border2); background: var(--bg3); }
.search-result-path { font-family: var(--mono); font-size: .72rem; color: var(--text3); margin-top: 2px; }

/* â”€â”€ Empty State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.empty-state {
  text-align: center;
  padding: 60px 32px;
  color: var(--text3);
}
.empty-state .empty-icon { font-size: 3rem; margin-bottom: 16px; }
.empty-state .empty-title { font-size: 1rem; font-weight: 700; color: var(--text2); margin-bottom: 8px; }
.empty-state .empty-sub { font-size: .82rem; font-family: var(--mono); line-height: 1.7; }

/* â”€â”€ Loading â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.loading-bar {
  height: 2px;
  background: var(--green);
  position: fixed;
  top: 0; left: 0;
  width: 0;
  z-index: 9999;
  transition: width .3s ease;
  box-shadow: 0 0 8px var(--green);
}

/* â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toast-container {
  position: fixed;
  bottom: 24px;
  right: 24px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 9999;
}
.toast {
  padding: 12px 18px;
  border-radius: var(--radius2);
  font-size: .82rem;
  font-weight: 600;
  max-width: 340px;
  animation: toastIn .25s ease;
  backdrop-filter: blur(8px);
  border: 1px solid transparent;
}
.toast-success { background: rgba(0,200,122,.15); border-color: var(--green3); color: var(--green); }
.toast-error   { background: var(--redBg); border-color: rgba(255,71,87,.3); color: var(--red); }
.toast-info    { background: var(--bg3); border-color: var(--border2); color: var(--text2); }
@keyframes toastIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: none; } }

/* â”€â”€ Spinner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.spinner {
  width: 16px; height: 16px;
  border: 2px solid var(--bg4);
  border-top-color: var(--green);
  border-radius: 50%;
  animation: spin .6s linear infinite;
  display: inline-block;
  flex-shrink: 0;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ Back link â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.back-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: .8rem;
  color: var(--text3);
  cursor: pointer;
  margin-bottom: 20px;
  transition: color var(--transition);
  font-weight: 500;
}
.back-link:hover { color: var(--green); }

/* â”€â”€ Progress indicator â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.progress-ring {
  position: relative;
  width: 36px; height: 36px;
}
.progress-ring svg { transform: rotate(-90deg); }
.progress-ring circle { fill: none; stroke: var(--bg4); stroke-width: 3; }
.progress-ring .fill { stroke: var(--green); stroke-dasharray: 100; stroke-dashoffset: 100; transition: stroke-dashoffset .5s ease; stroke-linecap: round; }

/* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 768px) {
  .shell { grid-template-columns: 1fr; grid-template-rows: 56px auto 1fr; grid-template-areas: "topbar" "sidebar" "main"; }
  .sidebar { max-height: 180px; border-right: none; border-bottom: 1px solid var(--border); }
  .panel { padding: 16px; }
  .archive-grid { grid-template-columns: 1fr 1fr; }
}
</style>
</head>
<body>

<div class="loading-bar" id="loadingBar"></div>
<div class="toast-container" id="toastContainer"></div>

<div class="shell">

  <!-- â”€â”€ Topbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <header class="topbar">
    <a href="/" class="topbar-logo">
      <div class="logo-mark">I</div>
      <span>Ilija<em>DMS</em></span>
    </a>
    <div class="topbar-divider"></div>
    <div class="search-wrap">
      <span class="icon">âŒ•</span>
      <input type="text" id="searchInput" placeholder="Archiv durchsuchen..." autocomplete="off">
    </div>
    <div class="topbar-actions">
      <button class="btn btn-ghost" onclick="showPanel('import')" id="navImport">
        â†‘ Importieren
      </button>
      <button class="btn btn-primary" onclick="triggerSort()" id="sortBtn">
        âœ¦ Einsortieren
      </button>
    </div>
  </header>

  <!-- â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <aside class="sidebar">
    <div class="stats-bar" id="statsBar">
      <div class="stat-item">
        <div class="stat-value" id="statDocs">â€“</div>
        <div class="stat-label">Dokumente</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="statSize">â€“</div>
        <div class="stat-label">Speicher</div>
      </div>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-label">Navigation</div>
      <div class="sidebar-item active" id="nav-archiv" onclick="showPanel('archiv')">
        <span class="icon">ğŸ—‚</span>
        Archiv
        <span class="badge" id="archivBadge">0</span>
      </div>
      <div class="sidebar-item" id="nav-import" onclick="showPanel('import')">
        <span class="icon">ğŸ“¥</span>
        Import
        <span class="badge" id="importBadge">0</span>
      </div>
      <div class="sidebar-item" id="nav-search" onclick="showPanel('search')">
        <span class="icon">ğŸ”</span>
        Suche
      </div>
    </div>

    <div class="sidebar-section" id="catNavSection" style="display:none">
      <div class="sidebar-label">Kategorien</div>
      <div id="catNav"></div>
    </div>
  </aside>

  <!-- â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <main class="main">

    <!-- Archiv Panel -->
    <section class="panel active" id="panel-archiv">
      <div class="panel-header">
        <h1 class="panel-title" id="archivTitle">Alle <span>Kategorien</span></h1>
        <div id="archivActions"></div>
      </div>
      <div id="archivContent">
        <div class="empty-state">
          <div class="empty-icon">ğŸ—„ï¸</div>
          <div class="empty-title">Archiv wird geladen...</div>
        </div>
      </div>
    </section>

    <!-- Import Panel -->
    <section class="panel" id="panel-import">
      <div class="panel-header">
        <h1 class="panel-title">Dokumente <span>importieren</span></h1>
      </div>

      <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
        <span class="dz-icon">ğŸ“‚</span>
        <div class="dz-title">Dateien hierher ziehen</div>
        <div class="dz-sub">
          oder klicken zum AuswÃ¤hlen<br>
          PDF Â· DOCX Â· XLSX Â· JPG Â· PNG Â· TXT Â· CSV Â· MD Â· und mehr
        </div>
      </div>
      <input type="file" id="fileInput" multiple accept="*/*">

      <div id="importList" class="import-list"></div>

      <div id="sortBar" class="sort-bar" style="display:none">
        <p>
          <strong id="sortCount">0</strong> Dokument(e) bereit zum Einsortieren.
          Die KI analysiert und archiviert sie automatisch.
        </p>
        <button class="btn btn-primary" onclick="triggerSort()" id="sortBtnImport">
          âœ¦ Jetzt einsortieren
        </button>
      </div>

      <div id="sortOutput" class="sort-output"></div>
    </section>

    <!-- Search Panel -->
    <section class="panel" id="panel-search">
      <div class="panel-header">
        <h1 class="panel-title">Archiv <span>durchsuchen</span></h1>
      </div>
      <div id="searchResults" class="search-results">
        <div class="empty-state">
          <div class="empty-icon">ğŸ”</div>
          <div class="empty-title">Suchbegriff eingeben</div>
          <div class="empty-sub">Suche in der Topbar beginnen</div>
        </div>
      </div>
    </section>

  </main>
</div>

<script>
// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let archivTree  = [];
let currentCat  = null;
let searchDebounce = null;

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener("DOMContentLoaded", () => {
  loadStats();
  loadArchiv();
  loadImportList();
  setupDropZone();
  setupSearch();
});

// â”€â”€ Loading Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startLoad() { document.getElementById("loadingBar").style.width = "70%"; }
function endLoad()   { const b = document.getElementById("loadingBar"); b.style.width = "100%"; setTimeout(() => b.style.width = "0", 300); }

// â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toast(msg, type = "info") {
  const el  = document.createElement("div");
  el.className = `toast toast-${type}`;
  el.textContent = msg;
  document.getElementById("toastContainer").appendChild(el);
  setTimeout(() => el.remove(), 4000);
}

// â”€â”€ Panel switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPanel(name) {
  document.querySelectorAll(".panel").forEach(p => p.classList.remove("active"));
  document.querySelectorAll(".sidebar-item").forEach(i => i.classList.remove("active"));
  document.getElementById(`panel-${name}`).classList.add("active");
  const nav = document.getElementById(`nav-${name}`);
  if (nav) nav.classList.add("active");

  if (name === "import") loadImportList();
  if (name === "search") document.getElementById("searchInput").focus();
}

// â”€â”€ Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadStats() {
  try {
    const r = await fetch("/api/dms/stats");
    const d = await r.json();
    document.getElementById("statDocs").textContent = d.gesamt ?? 0;
    const mb = d.groesse_mb ?? 0;
    document.getElementById("statSize").textContent = mb < 1 ? `${Math.round(mb * 1024)} KB` : `${mb} MB`;
    document.getElementById("importBadge").textContent = d.import_count ?? 0;
    document.getElementById("archivBadge").textContent = d.gesamt ?? 0;
  } catch (e) { console.error(e); }
}

// â”€â”€ Archive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadArchiv() {
  startLoad();
  try {
    const r = await fetch("/api/dms/tree");
    archivTree = await r.json();
    renderArchivRoot();
    renderCatNav();
  } catch (e) {
    document.getElementById("archivContent").innerHTML =
      `<div class="empty-state"><div class="empty-icon">âš ï¸</div><div class="empty-title">Archiv konnte nicht geladen werden</div></div>`;
  }
  endLoad();
}

function renderArchivRoot() {
  currentCat = null;
  document.getElementById("archivTitle").innerHTML = `Alle <span>Kategorien</span>`;
  document.getElementById("archivActions").innerHTML = "";

  if (!archivTree || archivTree.length === 0) {
    document.getElementById("archivContent").innerHTML =
      `<div class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <div class="empty-title">Das Archiv ist noch leer</div>
        <div class="empty-sub">Lade Dokumente hoch und klicke "Einsortieren"<br>die KI ordnet sie automatisch ein.</div>
       </div>`;
    return;
  }

  const icons = {
    "Rechnungen":"ğŸ§¾","VertrÃ¤ge":"ğŸ“‹","Versicherung":"ğŸ›¡","Steuern":"ğŸ’°",
    "BehÃ¶rden":"ğŸ›","Medizin":"âš•ï¸","Privat":"ğŸ ","Finanzen":"ğŸ“ˆ",
    "Arbeit":"ğŸ’¼","Immobilien":"ğŸ¢","Fahrzeuge":"ğŸš—","Bildung":"ğŸ“",
    "Unsortiert":"ğŸ“¦"
  };

  const grid = document.createElement("div");
  grid.className = "archive-grid";

  archivTree.forEach(cat => {
    const card = document.createElement("div");
    card.className = "cat-card";
    card.innerHTML = `
      <div class="cat-icon">${icons[cat.name] || "ğŸ“‚"}</div>
      <div class="cat-name">${cat.name}</div>
      <div class="cat-count">${cat.count} Dokument${cat.count !== 1 ? "e" : ""}</div>
    `;
    card.onclick = () => renderArchivCat(cat);
    grid.appendChild(card);
  });

  document.getElementById("archivContent").innerHTML = "";
  document.getElementById("archivContent").appendChild(grid);
}

function renderArchivCat(cat) {
  currentCat = cat;
  document.getElementById("archivTitle").innerHTML = `${cat.name}`;
  document.getElementById("archivActions").innerHTML =
    `<button class="btn btn-ghost" onclick="renderArchivRoot()">â† ZurÃ¼ck</button>`;

  const container = document.createElement("div");

  cat.subs.forEach(sub => {
    const subHeader = document.createElement("div");
    subHeader.style.cssText = "margin-bottom: 6px; margin-top: 16px;";
    subHeader.innerHTML = `
      <div style="font-size:.7rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text3);margin-bottom:8px">
        ğŸ“ ${sub.name.replace("/", " Â· ")}
      </div>`;
    container.appendChild(subHeader);

    const list = document.createElement("div");
    list.className = "file-list";

    sub.dateien.forEach(doc => {
      const row = document.createElement("div");
      row.className = "file-row";
      const extClass = getExtClass(doc.ext);
      const sizeStr  = doc.groesse > 1024 * 1024
        ? `${(doc.groesse / (1024*1024)).toFixed(1)} MB`
        : `${Math.round(doc.groesse / 1024)} KB`;

      row.innerHTML = `
        <div class="file-ext ${extClass}">${doc.ext || "?"}</div>
        <div class="file-info">
          <div class="file-name">${doc.name}</div>
          <div class="file-meta">${sizeStr} Â· ${doc.datum}</div>
        </div>
        <div class="file-actions">
          <button class="file-action-btn" onclick="downloadFile('${doc.pfad}')">â¬‡ Download</button>
        </div>`;
      list.appendChild(row);
    });

    container.appendChild(list);
  });

  if (cat.count === 0) {
    container.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“‚</div><div class="empty-title">Keine Dokumente</div></div>`;
  }

  document.getElementById("archivContent").innerHTML = "";
  document.getElementById("archivContent").appendChild(container);
}

function renderCatNav() {
  const nav = document.getElementById("catNav");
  nav.innerHTML = "";
  if (!archivTree || archivTree.length === 0) { document.getElementById("catNavSection").style.display = "none"; return; }
  document.getElementById("catNavSection").style.display = "block";

  archivTree.forEach(cat => {
    const item = document.createElement("div");
    item.className = "sidebar-item";
    item.innerHTML = `<span class="icon" style="font-size:12px">ğŸ“‚</span> ${cat.name} <span class="badge">${cat.count}</span>`;
    item.onclick = () => { showPanel("archiv"); renderArchivCat(cat); };
    nav.appendChild(item);
  });
}

// â”€â”€ Import â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadImportList() {
  try {
    const r    = await fetch("/api/dms/import-list");
    const list = await r.json();
    renderImportList(list);
    document.getElementById("importBadge").textContent = list.length;
    document.getElementById("sortBar").style.display = list.length > 0 ? "flex" : "none";
    document.getElementById("sortCount").textContent  = list.length;
  } catch (e) { console.error(e); }
}

function renderImportList(files) {
  const el = document.getElementById("importList");
  el.innerHTML = "";
  if (files.length === 0) {
    el.innerHTML = `<div class="empty-state" style="padding:32px">
      <div class="empty-icon">ğŸ“¥</div>
      <div class="empty-title">Import-Ordner ist leer</div>
      <div class="empty-sub">Ziehe Dateien in die Zone oben oder klicke zum AuswÃ¤hlen</div>
    </div>`;
    return;
  }
  files.forEach(f => {
    const item = document.createElement("div");
    item.className = "import-item";
    const extClass = getExtClass(f.ext);
    const sizeStr  = f.groesse > 1024 ? `${Math.round(f.groesse / 1024)} KB` : `${f.groesse} B`;
    item.innerHTML = `
      <div class="file-ext ${extClass}">${f.ext || "?"}</div>
      <div class="import-item-info">
        <div class="import-item-name">${f.name}</div>
        <div class="import-item-meta">${sizeStr}</div>
      </div>
      <button class="import-item-del" onclick="deleteImport('${f.name}', this)" title="Entfernen">âœ•</button>
    `;
    el.appendChild(item);
  });
}

async function deleteImport(name, btn) {
  btn.disabled = true;
  try {
    await fetch("/api/dms/delete", {
      method: "DELETE",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name }),
    });
    toast(`${name} entfernt`, "info");
    await loadImportList();
  } catch (e) { toast("Fehler beim LÃ¶schen", "error"); btn.disabled = false; }
}

// â”€â”€ Upload â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setupDropZone() {
  const zone  = document.getElementById("dropZone");
  const input = document.getElementById("fileInput");

  ["dragenter", "dragover"].forEach(e => zone.addEventListener(e, ev => { ev.preventDefault(); zone.classList.add("dragover"); }));
  ["dragleave", "drop"].forEach(e => zone.addEventListener(e, ev => { ev.preventDefault(); zone.classList.remove("dragover"); }));

  zone.addEventListener("drop", ev => {
    const files = ev.dataTransfer.files;
    if (files.length) uploadFiles(files);
  });

  input.addEventListener("change", () => { if (input.files.length) uploadFiles(input.files); input.value = ""; });
}

async function uploadFiles(files) {
  startLoad();
  const fd = new FormData();
  Array.from(files).forEach(f => fd.append("files", f));
  try {
    const r = await fetch("/api/dms/upload", { method: "POST", body: fd });
    const d = await r.json();
    toast(`${d.anzahl} Datei(en) hochgeladen`, "success");
    if (d.fehler?.length) d.fehler.forEach(e => toast(e, "error"));
    await loadImportList();
    loadStats();
  } catch (e) { toast("Upload fehlgeschlagen", "error"); }
  endLoad();
}

// â”€â”€ Sort â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function triggerSort() {
  const btn1 = document.getElementById("sortBtn");
  const btn2 = document.getElementById("sortBtnImport");
  const out  = document.getElementById("sortOutput");

  [btn1, btn2].forEach(b => { if (b) { b.disabled = true; b.innerHTML = `<span class="spinner"></span> KI analysiert...`; } });
  out.textContent = "â³ KI analysiert und sortiert Dokumente ein...\n";
  out.classList.add("visible");
  showPanel("import");
  startLoad();

  try {
    const r = await fetch("/api/dms/sort", { method: "POST" });
    const d = await r.json();

    if (d.error) {
      out.textContent += `\nâŒ Fehler: ${d.error}`;
      toast("Fehler beim Einsortieren", "error");
    } else {
      out.textContent = d.ergebnis;
      toast("Dokumente erfolgreich einsortiert âœ“", "success");
      await loadImportList();
      await loadArchiv();
      await loadStats();
    }
  } catch (e) {
    out.textContent += `\nâŒ Verbindungsfehler: ${e.message}`;
    toast("Verbindungsfehler", "error");
  }

  [btn1, btn2].forEach(b => { if (b) { b.disabled = false; b.innerHTML = b === btn1 ? "âœ¦ Einsortieren" : "âœ¦ Jetzt einsortieren"; } });
  endLoad();
}

// â”€â”€ Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setupSearch() {
  document.getElementById("searchInput").addEventListener("input", e => {
    clearTimeout(searchDebounce);
    const q = e.target.value.trim();
    if (!q) {
      document.getElementById("searchResults").innerHTML =
        `<div class="empty-state"><div class="empty-icon">ğŸ”</div><div class="empty-title">Suchbegriff eingeben</div></div>`;
      return;
    }
    showPanel("search");
    searchDebounce = setTimeout(() => performSearch(q), 350);
  });
}

async function performSearch(q) {
  const container = document.getElementById("searchResults");
  container.innerHTML = `<div style="display:flex;align-items:center;gap:10px;padding:16px;color:var(--text3)"><span class="spinner"></span> Suche lÃ¤uft...</div>`;
  try {
    const r  = await fetch(`/api/dms/search?q=${encodeURIComponent(q)}`);
    const ds = await r.json();

    if (ds.length === 0) {
      container.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ”</div><div class="empty-title">Keine Ergebnisse fÃ¼r "${q}"</div></div>`;
      return;
    }

    container.innerHTML = `<div style="font-size:.75rem;color:var(--text3);margin-bottom:12px;font-family:var(--mono)">${ds.length} Treffer fÃ¼r "${q}"</div>`;
    const list = document.createElement("div");
    list.className = "search-results";

    ds.forEach(doc => {
      const item = document.createElement("div");
      item.className = "search-result-item";
      const extClass = getExtClass(doc.ext);
      const sizeStr  = doc.groesse > 1024 ? `${Math.round(doc.groesse / 1024)} KB` : `${doc.groesse} B`;
      item.innerHTML = `
        <div class="file-ext ${extClass}">${doc.ext || "?"}</div>
        <div style="flex:1;min-width:0">
          <div class="file-name" style="font-size:.85rem;font-weight:600;color:var(--text)">${doc.name}</div>
          <div class="search-result-path">${doc.pfad}</div>
        </div>
        <div style="font-size:.72rem;font-family:var(--mono);color:var(--text3);margin-right:10px">${sizeStr}</div>
        <button class="file-action-btn" onclick="downloadFile('${doc.pfad}')">â¬‡</button>
      `;
      list.appendChild(item);
    });
    container.appendChild(list);
  } catch (e) {
    container.innerHTML = `<div class="empty-state"><div class="empty-icon">âš ï¸</div><div class="empty-title">Suche fehlgeschlagen</div></div>`;
  }
}

// â”€â”€ Download â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function downloadFile(pfad) {
  window.location.href = `/api/dms/download?pfad=${encodeURIComponent(pfad)}`;
}

// â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getExtClass(ext) {
  const e = (ext || "").toLowerCase();
  if (e === "pdf")  return "ext-pdf";
  if (["docx","doc","odt"].includes(e)) return "ext-docx";
  if (["xlsx","xls","xlsm","ods","csv"].includes(e)) return "ext-xlsx";
  if (["jpg","jpeg","png","webp","tiff","tif","bmp","heic"].includes(e)) return "ext-img";
  if (["txt","md","rtf"].includes(e)) return "ext-txt";
  return "ext-default";
}
</script>
</body>
</html>
